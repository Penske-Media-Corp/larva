@import "true";
@import "../lib/tools/tools";

@include test-module('@mixin _a-grid-generator') {

	@include test('generates non-namepsaced grids') {
		@include assert {

			@include output {
				$grids: (
					(
						columns: 2,
						spans: ( 2, ),
					),
					(
						columns: 3,
						breakpoint: tablet,
						spans: ( 2, ),
					),
				);

				@include _a-grid-generator( $grids );
			}

			@include expect {
				.a-cols2 {
					--cols: 2;
				}

				.a-cols2 > * {
					flex-basis: 50%;
				}

				@supports (display: grid) {
					.a-span2 {
						grid-column: span 2;
					}
				}

				.a-cols2 > .a-span2 {
					flex-basis: 100%;
				}

				@include pmc-breakpoint( tablet ) {
					.a-cols3\@tablet {
						--cols: 3;
					}

					.a-cols3\@tablet > * {
						flex-basis: 33.33333%;
					}
				}

				@include pmc-breakpoint( tablet ) {

					.a-span2\@tablet {
						@supports ( display: grid ) {
							grid-column: span 2;
						}
					}

					.a-cols3\@tablet > .a-span2\@tablet {
						flex-basis: 66.66667%;
					}
				}
			}

		}
	}

	@include test('generates namepsaced grids') {

		@import 'fixture/setup';

		@include assert {

			@include output {

				$grids: (
					(
						columns: 2,
						spans: ( 2, ),
					),
					(
						columns: 3,
						breakpoint: tablet,
						spans: ( 2, ),
					),
				);

				@include _a-grid-generator( $grids );
			}

			@include expect {
				.lrv-a-cols2 {
					--cols: 2;
				}

				.lrv-a-cols2 > * {
					flex-basis: 50%;
				}

				@supports (display: grid) {
					.lrv-a-span2 {
						grid-column: span 2;
					}
				}

				.lrv-a-cols2 > .lrv-a-span2 {
					flex-basis: 100%;
				}

				@include pmc-breakpoint( tablet ) {
					.lrv-a-cols3\@tablet {
						--cols: 3;
					}

					.lrv-a-cols3\@tablet > * {
						flex-basis: 33.33333%;
					}
				}

				@include pmc-breakpoint( tablet ) {

					.lrv-a-span2\@tablet {
						@supports ( display: grid ) {
							grid-column: span 2;
						}
					}

					.lrv-a-cols3\@tablet > .lrv-a-span2\@tablet {
						flex-basis: 66.66667%;
					}
				}
			}

		}
	}

	@include test('supports naming update') {

		$features: (
			'a-grid-namespace': true,
		);

		@import 'fixture/setup';

		@include assert {

			@include output {

				$grids: (
					(
						columns: 3,
						spans: ( 2, ),
					),
				);

				@include _a-grid-generator( $grids );
			}

			@include expect {
				.lrv-a-grid-cols-3 {
					--cols: 3;
				}

				.lrv-a-grid-cols-3 > * {
					flex-basis: 33.33333%;
				}

				@supports (display: grid) {
					.lrv-a-grid-item-span-2 {
						grid-column: span 2;
					}
				}

				.lrv-a-grid-cols-3 > .lrv-a-grid-item-span-2 {
					flex-basis: 66.66667%;
				}
			}

		}
	}
}